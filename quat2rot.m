function [rot] = quat2rot(quat)

    q = quat;
    x = q(1);
    y = q(2);
    z = q(3);
    w = q(4);
    rot = [
            1-2*y*y-2*z*z, 2*x*y+2*w*z, 2*x*z-2*w*y;
            2*x*y-2*w*z, 1-2*x*x-2*z*z, 2*y*z+2*w*x;
            2*x*z+2*w*y, 2*y*z-2*w*x, 1-2*x*x-2*y*y;
        ]';
    %rot = [
    %   q(1)*q(1) + q(2)*q(2) - q(3)*q(3) - q(4)*q(4),                   2*( q(2)*q(3) - q(1)*q(4) ),                     2*(q(2)*q(4) + q(1)*q(3));
    %                      2*( q(2)*q(3) + q(1)*q(4) ), q(1)*q(1) - q(2)*q(2) + q(3)*q(3) - q(4)*q(4),                     2*(q(3)*q(4) + q(1)*q(2));
    %                      2*( q(2)*q(4) + q(1)*q(3) ),                   2*( q(3)*q(4) + q(1)*q(2) ), q(1)*q(1) - q(2)*q(2) - q(3)*q(3) + q(4)*q(4);
    %];
    
    
end